(this["webpackJsonpcannon-fudder"]=this["webpackJsonpcannon-fudder"]||[]).push([[0],{10:function(e,t,a){e.exports=a.p+"static/media/logo.f5d6e48b.svg"},11:function(e,t,a){e.exports=a(19)},16:function(e,t,a){},18:function(e,t,a){},19:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(9),o=a.n(s),i=(a(16),a(6)),c=a.n(i),l=a(7),h=a(1),u=a(2),p=a(4),f=a(3),m=a(5),d=(a(18),a(10)),y=a.n(d),v=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).handleKeyboardEvents=function(e){switch(e.key){case"ArrowLeft":a.props.turnLeft();break;case"ArrowRight":a.props.turnRight();break;case"ArrowUp":a.props.morePower();break;case"ArrowDown":a.props.lessPower();break;case" ":a.props.fire()}},a.componentDidMount=function(){document.addEventListener("keydown",a.handleKeyboardEvents)},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.player?r.a.createElement("div",{className:"Controls"},r.a.createElement("label",{for:"Name"},"Name"),r.a.createElement("span",{className:"Name"},this.props.player.name),r.a.createElement("label",{for:"Health"},"Health"),r.a.createElement("span",{className:"Health"},this.props.player.health),r.a.createElement("label",{for:"Angle"},"Angle"),r.a.createElement("span",{className:"Angle"},r.a.createElement("input",{type:"number",className:"Angle",value:this.props.player.angle}),r.a.createElement("button",{onClick:this.props.turnLeft},"<"),r.a.createElement("button",{onClick:this.props.turnRight},">")),r.a.createElement("label",{for:"Power"},"Power"),r.a.createElement("span",{className:"Power"},r.a.createElement("input",{type:"number",className:"Angle",value:this.props.player.power}),r.a.createElement("button",{onClick:this.props.lessPower},"-"),r.a.createElement("button",{onClick:this.props.morePower},"+")),r.a.createElement("button",{id:"fire",onClick:this.props.fire},"Fire")):null}}]),t}(r.a.Component),g=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={name:""},a.update=function(e){a.setState({name:e.target.value})},a.add=Object(l.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==a.state.name.trim()){e.next=4;break}return e.next=3,a.props.controller.flashError("Please enter a user name");case 3:return e.abrupt("return");case 4:if(!a.props.list.includes(a.state.name)){e.next=8;break}return e.next=7,a.props.controller.flashError("Name is taken, choose another one");case 7:return e.abrupt("return");case 8:a.props.addPlayer(a.state.name),a.setState({name:""});case 10:case"end":return e.stop()}}),e)}))),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"AddPlayer"},r.a.createElement("input",{className:"center-relative-h",id:"name",onChange:this.update,value:this.state.name}),r.a.createElement("button",{className:"center-relative-h",onClick:this.add},"Add Player"))}}]),t}(r.a.Component),b=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={name:""},a.update=function(e){a.setState({name:e.target.value})},a.add=function(){a.props.addPlayer(a.state.name)},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.list.map((function(e){return r.a.createElement("div",{className:"WaitingPlayer"},e.name," ",r.a.createElement("span",{className:"Health"},e.health))}))}}]),t}(r.a.Component);function w(e){this._seed=e%2147483647,this._seed<=0&&(this._seed+=2147483646)}w.prototype.next=function(){return this._seed=16807*this._seed%2147483647},w.prototype.nextFloat=function(e,t){return(this.next()-1)/2147483646};var P=function(){this.frequency=10,this.subDivision=10,this.highLimit=300,this.lowLimit=500,this.lastPos={x:0,y:0},this.points=[],this.width=window.innerWidth};function x(e,t){return Math.floor(Math.random()*(t-e+1))+e}function E(e,t,a){var n=3.1415927*a,r=.5*(1-Math.cos(n));return e*(1-r)+t*r}P.prototype.fill=function(){var e=[];if(this.lastPos={x:this.lastPos.x,y:x(this.lowLimit,this.highLimit)},this.points.length>0){this.lastPos={x:0,y:this.points[0][1]};for(var t=0;t<this.frequency;t++)for(var a=this.add(null,this.points[t][1]),n=0;n<a.length;n++)e.push(a[n])}else for(var r=0;r<this.frequency;r++)for(var s=this.add(),o=0;o<s.length;o++)e.push(s[o]);return e},P.prototype.add=function(e,t){var a,n;a=e||this.lastPos.x+this.width/this.frequency,n=t||x(this.lowLimit,this.highLimit);for(var r=[],s=0;s<this.subDivision;s++){var o=s/this.subDivision,i=(a-this.lastPos.x)/this.subDivision*s+this.lastPos.x,c=E(this.lastPos.y,n,o);r.push({x:i,y:c})}return this.lastPos={x:a,y:n},r};var k=P,M=Math.PI/180,O=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).createHeightMap=function(){a.noise=new k,a.noise.frequency=10,a.noise.subDivision=10,a.noise.highLimit=window.innerHeight/3,a.noise.lowLimit=20,a.noise.lastPos={x:0,y:0},a.noise.width=a.cnv.offsetWidth,a.map=a.noise.fill(),a.props.controller.paintStage=a.paintStage,a.props.controller.getStartingPosition=function(){return a.map.random()}},a.paintStage=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=a.cnv.offsetWidth,n=a.cnv.offsetHeight,r=a.ctx;r.fillStyle="#00f",r.fillRect(0,0,t,n),r.fillStyle="#0f0",r.beginPath(),r.moveTo(0,n);var s=null;if(a.map.forEach((function(e){s=e,r.lineTo(e.x,n-e.y)})),r.lineTo(t,n-s.y),r.lineTo(t,n),r.lineTo(0,n),r.closePath(),r.fill(),r.fillStyle="#f00",a.props.controller.state.player.forEach((function(e){r.beginPath(),r.arc(e.x,n-e.y,10,0,2*Math.PI),r.fill(),r.beginPath(),r.moveTo(e.x,n-e.y);var t=(720-e.angle)%360,a=12*Math.cos(t*M),s=12*Math.sin(t*M);r.lineTo(e.x+a,n-e.y+s),r.stroke()})),e){r.fillStyle="#000",r.beginPath(),r.arc(e.x,n-e.y,3,0,2*Math.PI),r.fill();var o=Math.round(e.x),i=Math.round(e.y),c=a.cachedCtx.getImageData(o,n-i,1,1).data;if(0==c[0]&&255==c[1]&&0==c[2]&&255==c[3])return!0;if(e.x<0||e.x>t||e.y<0)return!0}return!1},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.cnv=document.getElementById("stage"),this.cnv.width=window.innerWidth,this.cnv.height=window.innerHeight,this.ctx=this.cnv.getContext("2d"),this.createHeightMap(),this.paintStage(),this.cachedMap=new OffscreenCanvas(this.cnv.width,this.cnv.height),this.cachedCtx=this.cachedMap.getContext("2d"),this.cachedCtx.drawImage(this.cnv,0,0)}},{key:"render",value:function(){return r.a.createElement("div",{className:"Battlefield"},r.a.createElement("canvas",{id:"stage"}))}}]),t}(r.a.Component),j=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"ErrorBox"},this.props.message)}}]),t}(r.a.Component);Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]};var S=9.81,N=Math.PI/180;Math.TAU=2*Math.PI;var A=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={player:[],currentPlayer:null,controlsBlocked:!0,showSettings:!0},a.addPlayer=function(e){var t={name:e,health:100,points:0,angle:45,power:100};Object.assign(t,a.getStartingPosition()),a.state.player.push(t),a.state.currentPlayer=a.state.currentPlayer||t,a.forceUpdate()},a.turnLeft=function(){a.state.controlsBlocked||a.state.currentPlayer&&(a.state.currentPlayer.angle-=5,a.forceUpdate())},a.turnRight=function(){a.state.controlsBlocked||a.state.currentPlayer&&(a.state.currentPlayer.angle+=5,a.forceUpdate())},a.lessPower=function(){a.state.controlsBlocked||a.state.currentPlayer&&(a.state.currentPlayer.power-=5,a.forceUpdate())},a.morePower=function(){a.state.controlsBlocked||a.state.currentPlayer&&(a.state.currentPlayer.power+=5,a.forceUpdate())},a.fire=Object(l.a)(c.a.mark((function e(){var t,n,r,s,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.state.controlsBlocked){e.next=2;break}return e.abrupt("return");case 2:if(a.state.currentPlayer){e.next=4;break}return e.abrupt("return");case 4:return a.setState({controlsBlocked:!0}),t=0,n=a.state.currentPlayer,r=(720-n.angle)%360,s=n.x+6*Math.cos(r*N),o=n.y-6*Math.sin(r*N),i={x:s,y:o},e.next=13,new Promise((function(e){var r=setInterval((function(){t+=.033,i.x=s+n.power*t*Math.cos(n.angle*N),i.y=o+n.power*t*Math.sin(n.angle*N)-S*Math.pow(t,2)/2,requestAnimationFrame((function(){a.paintStage(i)&&(a.state.player.forEach((function(e){var t=Math.abs(e.x-i.x),a=Math.abs(e.y-i.y),n=Math.sqrt(Math.pow(t,2)+Math.pow(a,2));n<20&&(e.health=Math.floor(e.health-(20-n)))})),clearTimeout(r),e())}))}),16)}));case 13:a.setState({controlsBlocked:!1}),a.nextPlayer();case 15:case"end":return e.stop()}}),e)}))),a.nextPlayer=function(){var e=a.state.player,t=(e.indexOf(a.state.currentPlayer)+1)%e.length,n=e[t];a.setState({currentPlayer:n})},a.flashError=function(){var e=Object(l.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({errorMessage:t}),e.next=3,new Promise((function(e){setTimeout(e,2e3)}));case 3:a.setState({errorMessage:null});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.startGame=function(){a.setState({showSettings:!1,controlsBlocked:!1})},a.componentDidUpdate=function(){a.paintStage(!1)},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){window.App=this;var e=this.state.currentPlayer,t=this.state.player.filter((function(t){return t!==e})),a=this.state.player.map((function(e){return e.name}));return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"Header"}),this.state.errorMessage?r.a.createElement(j,{message:this.state.errorMessage}):null,r.a.createElement(v,{player:e,turnLeft:this.turnLeft,turnRight:this.turnRight,lessPower:this.lessPower,morePower:this.morePower,fire:this.fire}),r.a.createElement("div",{className:"WaitingPlayers"},r.a.createElement(b,{list:t})),this.state.showSettings?r.a.createElement("div",{className:"Settings"},r.a.createElement("img",{src:y.a,className:"App-logo",alt:"logo"}),r.a.createElement(g,{addPlayer:this.addPlayer,list:a,controller:this}),r.a.createElement("button",{className:"start center-relative-h",onClick:this.startGame},"Start Game")):null,r.a.createElement(O,{controller:this}))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[11,1,2]]]);
//# sourceMappingURL=main.4899932b.chunk.js.map